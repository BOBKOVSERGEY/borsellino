//menu catalog
(function() {
    var panelItem = document.querySelectorAll('.catalog-menu-title'),
        active = document.getElementsByClassName('catalog-menu-title-active');

    Array.from(panelItem).forEach(function(item, i, panelItem) {
        item.addEventListener('click', function(e) {
            if (active.length > 0 && active[0] !== this)
                active[0].classList.remove('catalog-menu-title-active');
            this.classList.toggle('catalog-menu-title-active');
        });
    });
})();

// Preloader
$(".preloader").fadeOut();



$(function () {
  /*basket*/
  $('.basket__product').on('click', function (event) {
    event.preventDefault();
    $('.basket__up').slideToggle(100);
  })
  /*end-basket*/

  /*promo*/
  $('.cart__sidebar-promo-link-a').on('click', function (event) {
    event.preventDefault();
    $('.cart__sidebar-promo-content').slideToggle();
  })
  /*promo*/
  /*bonus*/
  $('.cart__sidebar-bonus-link-a').on('click', function (event) {
    event.preventDefault();
    $('.cart__sidebar-bonus-content').slideToggle();
  })
  /*bonus*/
  /*hearth*/
  $('.cart__icon-heart-red').on('click', function (event) {
    event.preventDefault();
    if($(this).attr('src') == 'assets/icons/hearth1.svg') {
      $(this).attr('src', 'assets/icons/hearth2.svg');
    } else {
      $(this).attr('src', 'assets/icons/hearth1.svg');
    }
  });
  /*endhearth*/

  /*sticky sidebar*/
  var parentElement = $('.cart__sidebar');
  var stickyElement = $('.sticky-sidebar');
  var container = $('.cart__blocks');
  var containerHeight = container.height() + 'px';
  var mediaBreakPoint = '(max-width: 980px)';
  var height = stickyElement.height();
  var heightString = height + 2 + 'px';
  var widthString = stickyElement.width() + 2 + 'px';

  function scrollStickySidebar() {
    $(window).scroll(function () {
        var scroll = $(this).scrollTop();

        setParentOrContainerHeight();
        setStickyElementScrollDefaultStyles();

        var length = parentElement.height() - stickyElement.height() + parentElement.offset().top;

        if (!window.matchMedia(mediaBreakPoint).matches) {
          if (scroll < parentElement.offset().top) {
            stickyElement.css({
              'position': 'absolute',
              'top': '0',
              'bottom': 'auto',
              'margin-top': '0px'
            });
          }
          else if (scroll > length) {
            stickyElement.css({
              'position': 'absolute',
              'top': 'auto',
              'bottom': '0'
            });
          }
          else {
            stickyElement.css({
              'position': 'fixed',
              'top': '0',
              'bottom': 'auto',
              'margin-top': '10px'
            });
          }
        }
        else {
          setStickyElementMobileDefaultStyles();
        }
      }
    )};


  function setStickyElementScrollDefaultStyles() {
    stickyElement.css({
      'height': 'auto',
      'width': widthString,
      'max-width': widthString
    });
  }

  function setStickyElementMobileDefaultStyles() {
    setParentToAutoHeight();

    stickyElement.css({
      'position': 'relative',
      'top': 'auto',
      'bottom': 'auto',
      'height': 'auto',
      'width': '100%',
      'max-width': '16.688em'
    });
  }

  function setParentOrContainerHeight() {
    if (height < container.height()) {
      parentElement.css({
        'height': containerHeight
      });
    }
    else {
      parentElement.css({
        'height': heightString
      });
      container.css({
        'height': heightString
      });
    }
  }

  function setParentToAutoHeight() {
    parentElement.css({
      'height': 'auto'
    });
  }

  scrollStickySidebar();

  $(window).resize(scrollStickySidebar);
  /*end sticky sidebar*/

  /*select option*/
  $('.custom-select-trigger').on('click', function(e){
    e.preventDefault();
    $(this).next('.custom-select').slideToggle('fast');
  });
  $('.custom-select li').on('click', function() {
    $(this).parents(".custom-select").next("select").val($(this).data("value"));
    $(this).parents(".custom-select").slideToggle("fast");
  });
  /*end select option*/
/*button plus minus*/
  $('.cart__product-quantity-minus').on('click', function () {
    var $input = $(this).parent().find('input');
    var count = parseInt($input.val()) - 1;
    count = count < 1 ? 1 : count;
    $input.val(count);
    $input.change();
    return false;
  });
  $('.cart__product-quantity-plus').on('click', function () {
    var $input = $(this).parent().find('input');
    $input.val(parseInt($input.val()) + 1);
    $input.change();
    return false;
  });
  /*end button plus minus*/

})





